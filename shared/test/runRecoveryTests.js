#!/usr/bin/env node

/**
 * Recovery System Test Runner
 * Executa todos os testes de resili√™ncia do sistema de recupera√ß√£o
 */

const { runRecoverySystemTests } = require('./recoverySystemTest.js');

async function main() {
  console.log('üöÄ Iniciando bateria completa de testes de resili√™ncia...\n');
  
  try {
    const startTime = Date.now();
    
    // Executa testes de resili√™ncia
    const results = await runRecoverySystemTests();
    
    const endTime = Date.now();
    const duration = endTime - startTime;
    
    console.log(`\n‚è±Ô∏è  Tempo total de execu√ß√£o: ${duration}ms`);
    
    // Verifica se todos os testes passaram
    const allPassed = results.every(result => result.success);
    
    if (allPassed) {
      console.log('\nüéâ TODOS OS TESTES DE RESILI√äNCIA PASSARAM!');
      console.log('‚úÖ Sistema de recupera√ß√£o autom√°tica est√° funcionando corretamente');
      process.exit(0);
    } else {
      console.log('\n‚ùå ALGUNS TESTES FALHARAM');
      console.log('‚ö†Ô∏è  Sistema de recupera√ß√£o precisa de ajustes');
      process.exit(1);
    }
    
  } catch (error) {
    console.error('\nüí• Erro cr√≠tico durante os testes:', error.message);
    console.error(error.stack);
    process.exit(1);
  }
}

// Executa se chamado diretamente
if (require.main === module) {
  main();
}

module.exports = { main };